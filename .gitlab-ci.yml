include:
  - project: 'jet-studio-io/gitlab-template'
    ref: 'latest'
    file: 'gitlab-ci-template.yml'

stages:
  - ðŸ“¦ Build Image

Gitlab CI:
  extends: .build-base
  stage: ðŸ“¦ Build Image
  variables:
    DOCKER_IMAGE: 'jetx'
    DOCKER_TAG: 'gitlab-ci'
    DOCKER_FILE: 'Dockerfile_ci'
    DOCKER_BUILD_ARGS: '--build-arg PRODUCTION_IP=$PRODUCTION_IP --build-arg STAGING_IP=$STAGING_IP'
  when: manual

PHP cli:
  extends: .build-base
  stage: ðŸ“¦ Build Image
  variables:
    DOCKER_IMAGE: 'php'
    DOCKER_TAG: 'cli-v8'
    DOCKER_FILE: 'Dockerfile_php'
    DOCKER_BUILD_ARGS: '--build-arg PHP_IMAGE=8.2-cli-alpine'
  when: manual

PHP fpm:
  tags:
    - gitlab-org-docker # specific share runner for this job
  extends: .build-base
  stage: ðŸ“¦ Build Image
  variables:
    DOCKER_IMAGE: 'php'
    DOCKER_TAG: 'fpm-v8'
    DOCKER_FILE: 'Dockerfile_php'
    DOCKER_BUILD_ARGS: '--build-arg PHP_IMAGE=8.2-fpm-alpine'
    PLATFORM: 'linux/amd64,linux/arm64/v8'
  when: manual